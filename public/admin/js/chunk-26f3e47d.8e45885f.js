(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26f3e47d","chunk-2d0cc7c7","chunk-2d0d3c8f"],{"4dab":function(e,t,r){"use strict";r.r(t),r.d(t,"GetList",(function(){return i})),r.d(t,"AddObj",(function(){return s})),r.d(t,"UpdateObj",(function(){return o})),r.d(t,"DelObj",(function(){return d})),r.d(t,"GetObj",(function(){return u})),r.d(t,"GetAuthzData",(function(){return c})),r.d(t,"DoAuthz",(function(){return l}));var a=r("22ce"),n="/auth.admin";function i(e){return Object(a["b"])({url:n+"/list",method:"post",data:e})}function s(e){return Object(a["b"])({url:n+"/add",method:"post",data:e})}function o(e){return Object(a["b"])({url:n+"/edit",method:"post",data:e})}function d(e){return Object(a["b"])({url:n+"/del",method:"post",data:{id:e}})}function u(e){return Object(a["b"])({url:n+"/info",method:"get",params:{id:e}})}function c(){return Object(a["b"])({url:n+"/getAuthzData",method:"get"})}function l(e,t){return Object(a["b"])({url:n+"/authz",method:"post",data:{id:e,roleIds:t}})}},"5df0":function(e,t,r){"use strict";r.r(t),r.d(t,"crudOptions",(function(){return n}));var a=r("22ce"),n=function(e){return{options:{height:"100%"},rowHandle:{width:180,view:{thin:!0,text:null,disabled:function(){return!e.hasPermissions("auth.admin:list")}},edit:{thin:!0,text:null,disabled:function(){return!e.hasPermissions("auth.admin:edit")}},remove:{thin:!0,text:null,disabled:function(){return!e.hasPermissions("auth.admin:del")}},custom:[]},columns:[{title:"用户名",key:"username",search:{disabled:!1},form:{editDisabled:!0,rules:[{required:!0,message:"请输入用户名"}]},width:300,sortable:!0},{title:"昵称",key:"nickname",search:{disabled:!1},sortable:!0},{title:"密码",key:"password",form:{component:{props:{showPassword:!0}},helper:"填写则修改密码"},disabled:!0,sortable:!0},{title:"性别",key:"gender",type:"radio",width:70,dict:{data:[{value:1,label:"男"},{value:2,label:"女",color:"danger"},{value:0,label:"保密"}]},sortable:!0,show:!1},{title:"邮箱",key:"email",search:{disabled:!1},form:{rules:[{type:"email",message:"请输入正确的邮箱"}]},sortable:!0,show:!0},{title:"角色",key:"role_id",type:"select",width:300,dict:{url:"/auth.role/list",value:"id",label:"name",getData:function(e,t){return Object(a["b"])({url:e}).then((function(e){return e.data.records}))}},search:{disabled:!1},form:{disabled:!1},sortable:!0},{title:"状态",key:"status",type:"radio",width:300,dict:{data:[{value:1,label:"正常"},{value:2,label:"禁止登录",color:"danger"},{value:0,label:"未知"}]},sortable:!0,show:!0},{title:"创建时间",key:"create_time",type:"datetime",width:140,form:{disabled:!0},sortable:!0,show:!1},{title:"修改时间",key:"update_time",type:"datetime",width:140,form:{disabled:!0},sortable:!0,show:!1}]}}},f62a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("d2-container",{class:{"page-compact":e.crud.pageOptions.compact}},[r("template",{slot:"header"}),r("d2-crud-x",e._g(e._b({ref:"d2Crud",on:{authz:e.authzHandle}},"d2-crud-x",e._crudProps,!1),e._crudListeners),[r("div",{attrs:{slot:"header"},slot:"header"},[r("crud-search",{ref:"search",attrs:{options:e.crud.searchOptions},on:{submit:e.handleSearch}}),r("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"auth:admin:add",expression:"'auth:admin:add'"}],attrs:{slot:"header",size:"small",type:"primary"},on:{click:e.addRow},slot:"header"},[r("i",{staticClass:"el-icon-plus"}),e._v(" 新增")]),r("crud-toolbar",{attrs:{search:e.crud.searchOptions.show,compact:e.crud.pageOptions.compact,columns:e.crud.columns},on:{"update:search":function(t){return e.$set(e.crud.searchOptions,"show",t)},"update:compact":function(t){return e.$set(e.crud.pageOptions,"compact",t)},refresh:function(t){return e.doRefresh()},"columns-filter-changed":e.handleColumnsFilterChanged}})],1)]),r("el-dialog",{attrs:{title:"授予角色",visible:e.dialogPermissionVisible},on:{"update:visible":function(t){e.dialogPermissionVisible=t}}},[r("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},e._l(e.roleList,(function(t){return r("el-collapse-item",{key:t.platform.id,attrs:{title:t.platform.name,name:t.platform.id}},[r("el-checkbox-group",{model:{value:t.checked,callback:function(r){e.$set(t,"checked",r)},expression:"group.checked"}},e._l(t.roles,(function(t){return r("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1)})),1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatePermession(e.currentUserId)}}},[e._v("确定")])],1)],1)],2)},n=[],i=(r("99af"),r("4de4"),r("4160"),r("c975"),r("d81d"),r("a434"),r("159b"),r("b85c")),s=r("5df0"),o=r("1fbf"),d=r("4dab"),u={name:"User",mixins:[o["d2CrudPlus"].crud],data:function(){return{activeNames:[],roleList:[],checked:[],dialogPermissionVisible:!1,currentUserId:void 0}},methods:{getCrudOptions:function(){return Object(s["crudOptions"])(this)},pageRequest:function(e){return d["GetList"](e)},addRequest:function(e){return d["AddObj"](e)},updateRequest:function(e){return d["UpdateObj"](e)},delRequest:function(e){return d["DelObj"](e.id)},infoRequest:function(e){return d["GetObj"](e.id)},authzHandle:function(e){var t=this;d["GetAuthzData"]().then((function(r){var a=r.data,n=e.row.roles;null==n&&(n=[]),t.activeNames.splice(0,t.activeNames.length),a.forEach((function(e){e.checked=e.roles.map((function(e){return e.id})).filter((function(e){return n.indexOf(e)>=0})),t.activeNames.push(e.platform.id),console.log("checked",e.checked)})),t.$set(t,"roleList",a),t.currentUserId=e.row.id,t.dialogPermissionVisible=!0}))},updatePermession:function(e){var t,r=this,a=[],n=Object(i["a"])(this.roleList);try{for(n.s();!(t=n.n()).done;){var s=t.value;a=a.concat(s.checked)}}catch(o){n.e(o)}finally{n.f()}d["DoAuthz"](e,a).then((function(e){r.dialogPermissionVisible=!1,r.doRefresh()}))}}},c=u,l=r("2877"),h=Object(l["a"])(c,a,n,!1,null,null,null);t["default"]=h.exports}}]);